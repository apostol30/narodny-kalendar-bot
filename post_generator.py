from PIL import Image, ImageDraw, ImageFont
import os
import textwrap

def create_daily_post():
    # === –¢–ï–ö–°–¢ –í –†–ê–ó–ì–û–í–û–†–ù–û–ú –°–¢–ò–õ–ï (–æ—Ç –ª–∏—Ü–∞ –º—É–∂—á–∏–Ω—ã) ===
    caption = (
        "ÂÖÑÂºü, –∞ –≤—ã –∑–Ω–∞–ª–∏, —á—Ç–æ —Å–µ–≥–æ–¥–Ω—è ‚Äî 31 –¥–µ–∫–∞–±—Ä—è?\n\n"
        "–í –Ω–∞—Ä–æ–¥–µ —ç—Ç–æ—Ç –¥–µ–Ω—å –∑–æ–≤—É—Ç **–ú–æ–¥–µ—Å—Ç–æ–≤ –≤–µ—á–µ—Ä** ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ—Ä–æ–≥ —É—Ö–æ–¥—è—â–µ–≥–æ –≥–æ–¥–∞.\n\n"
        "–°—Ç–∞—Ä–∏–∫–∏ –≥–æ–≤–æ—Ä–∏–ª–∏: ¬´–ö–∞–∫ –ú–æ–¥–µ—Å—Ç–æ–≤ –≤–µ—á–µ—Ä –ø—Ä–æ–π–¥—ë—Ç ‚Äî —Ç–∞–∫ –∏ –≤–µ—Å—å –≥–æ–¥ –ø–æ–π–¥—ë—Ç¬ª. \n"
        "–ü–æ—ç—Ç–æ–º—É —Å—Ç–∞—Ä–∞–ª–∏—Å—å:\n"
        "‚Ä¢ –Ω–µ —Å—Å–æ—Ä–∏—Ç—å—Å—è,\n"
        "‚Ä¢ –æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–µ –∫—É—Å–æ—á–µ–∫ —Ö–ª–µ–±–∞ –∏ —â–µ–ø–æ—Ç–∫—É —Å–æ–ª–∏,\n"
        "‚Ä¢ –∏ –Ω–µ —Ç—É—à–∏—Ç—å –ª–∞–º–ø–∞–¥—É –¥–æ —É—Ç—Ä–∞ ‚Äî —á—Ç–æ–±—ã —É–¥–∞—á–∞ –Ω–µ —É—à–ª–∞ –∏–∑ –¥–æ–º–∞.\n\n"
        "–≠—Ç–æ –Ω–µ —Å—É–µ–≤–µ—Ä–∏–µ ‚Äî —ç—Ç–æ **–ø–∞–º—è—Ç—å –æ –ø–æ—Ä—è–¥–∫–µ, —É–≤–∞–∂–µ–Ω–∏–∏ –∏ –≤–µ—Ä–µ**.\n\n"
        "üëâ –ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ ¬´–ù–∞—Ä–æ–¥–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å¬ª –Ω–∞ RuTube ‚Äî\n"
        "—Ç–∞–º –∫–∞–∂–¥—ã–π –¥–µ–Ω—å: –º–æ–ª–∏—Ç–≤—ã, –ø—Ä–∏–º–µ—Ç—ã, –∏—Å—Ç–æ—Ä–∏—è –∏ —Å–æ–≤–µ—Ç—ã –æ—Ç –ø—Ä–µ–¥–∫–æ–≤.\n"
        "üîó https://rutube.ru/channel/23605491"
    )

    # === –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–ê–†–¢–ò–ù–ö–ò ===
    width, height = 1080, 1350
    img = Image.new('RGB', (width, height), color=(235, 230, 220))  # –Ω–µ–∂–Ω—ã–π –±–µ–∂–µ–≤—ã–π
    draw = ImageDraw.Draw(img)

    # –ü—É—Ç—å –∫ —à—Ä–∏—Ñ—Ç–∞–º
    font_title = None
    try:
        # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º Cormorant (–∫—Ä—É–ø–Ω—ã–π, –¥–ª—è –¥–∞—Ç—ã)
        font_title = ImageFont.truetype("CormorantGaramond-Bold.ttf", 140)
    except:
        try:
            # –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø—Ä–æ–±—É–µ–º PT Serif
            font_title = ImageFont.truetype("PTSerif-Regular.ttf", 120)
        except:
            # –ï—Å–ª–∏ –∏ –µ–≥–æ –Ω–µ—Ç ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–π, –Ω–æ –∫—Ä—É–ø–Ω—ã–π
            font_title = ImageFont.load_default()
            # –£–≤–µ–ª–∏—á–∏–º —Ä–∞–∑–º–µ—Ä —á–µ—Ä–µ–∑ scale (–µ—Å–ª–∏ PIL –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)
            try:
                font_title = ImageFont.load_default().font_variant(size=120)
            except:
                pass

    # –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –¥–∞—Ç—É –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
    date_text = "31 –¥–µ–∫–∞–±—Ä—è"
    bbox = draw.textbbox((0, 0), date_text, font=font_title)
    text_width = bbox[2] - bbox[0]
    text_height = bbox[3] - bbox[1]
    x = (width - text_width) // 2
    y = (height - text_height) // 2 - 30  # —á—É—Ç—å –≤—ã—à–µ —Ü–µ–Ω—Ç—Ä–∞

    draw.text((x, y), date_text, fill=(40, 35, 30), font=font_title)

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º
    image_path = "post.jpg"
    img.save(image_path, quality=95)
    return image_path, caption
